<title>bidintel</title>
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<!-- Angular Material -->
	<link rel="stylesheet" href="https://gitcdn.xyz/repo/angular/bower-material/master/angular-material.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular-animate.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular-aria.js"></script>
	<script src="https://gitcdn.xyz/repo/angular/bower-material/master/angular-material.js"></script>
	
	<!-- Material -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<link rel="stylesheet" href="/static/css/materialize.min.css">
	
</head>

<script>
function submit_bids() {
	$.ajax({
		url: 'FILL_THIS_IN',
		data: $('form').serialize(),
		type: 'POST',
		// Remove these eventually.
		success: function(response) {
			console.log(response);
		},
		error: function(error) {
			console.log(error);
		}
	});
	//$('form')[0].reset();
}

var app = angular.module('bidintel', ['ngMaterial']);
app.controller('bidController', function($http) {
	var self = this;
	self.bids = [];
	$http.get('/data/professors').then(function(data) {
		self.professors = data.data['professors'];
	});
	
	self.querySearch = function(q) {
		/*return q ? self.professors.filter((professor) {
			return professor['name'].includes(q);
		}) : self.professors;*/
		return q ? self.professors.filter(self.createFilterFor(q)) : self.professors;
		//return self.professors;
	}
	
	self.createFilterFor = function (query) {
		var lQ = angular.lowercase(query);
		return function filterFn(p) {
			//return true;
			console.log(p['name']);
			return p['name'].toLowerCase().includes(lQ);
		};
	}
	
	self.addBid = function() {
		self.bids.push({1:1});
	}
	
	self.removeBid = function(idx=0) {
		self.bids.splice(0, 1);
	}
});
</script>
<body>
<script type="text/javascript" src="/static/js/materialize.min.js"></script>
<script type="text/javascript" src="/static/js/ng-drag-drop/ng-drag-drop.min.js"></script>

<div style="margin-top: 24px; margin-left: 24px;" ng-app="bidintel" ng-controller="bidController as ctrl">
	<div style="margin-bottom: 12px;">
		<button class="waves-effect waves-light btn" ng-click="ctrl.addBid()">Add Bid</button>
		<button class="waves-effect waves-light btn" ng-click="ctrl.removeBid()">Remove Bid</button>
	</div>
	<div ng-repeat="bid in ctrl.bids">
		<md-autocomplete
			  style="width: 300px"
			  md-selected-item="bid['selectedItem']"
			  md-search-text="bid['searchText']"
			  md-items="item in ctrl.querySearch(bid['searchText'])"
			  md-item-text="item['name']"
			  md-min-length="0"
			  placeholder="Professor">
			<md-item-template>
				<span>{{ '{{item["name"]}}' }}</span>
			</md-item-template>
		</md-autocomplete>
	</div>
</div>

</body>